#!/bin/bash

if [ $# -lt 2 ]; then
  echo "Usage: $0 <directory> <date>"
  exit 1
fi

tag=$1
date=$2

out="/data/lsd/KS_nHYP_FA/$tag/index.html"
#echo "Writing $out"

echo '<html><head>' > $out
echo '<script type="text/javascript" src="http://bsm.physics.yale.edu/ext/plot-ts/nHYP/dygraph-combined.js"></script>' >> $out
echo '<style type="text/css">' >> $out
echo '  #main{' >> $out
echo '    margin-right:19em;' >> $out
echo '    position:relative;' >> $out
echo '    min-height:0' >> $out
echo '  }' >> $out
echo '  #side{' >> $out
echo '    float:right;' >> $out
echo '    display:inline;' >> $out
echo '    width:18em;' >> $out
echo '    padding-bottom:1.3em;' >> $out
echo '    position:relative;' >> $out
echo '    color:#e3e3e3;' >> $out
echo '    overflow:hidden' >> $out
echo '  }' >> $out
echo '  #main h2 {background-color:#f0f0f0}' >> $out
echo '  #side, #side h2, #side h3 {background:#000; color:#e3e3e3}' >> $out
echo '  #side h2 {border-bottom:1px solid #484b51}' >> $out

echo '  #side a.active{font-weight:700; color:#f72; text-decoration:none}' >> $out
echo '  #side a {display:block; border-width:0 0 1px; border-color:#445; color:#f0f0f0}' >> $out
echo '  #side a:hover, #side a:active, #side a:focus {background-color:#334}' >> $out
echo '  a {padding:1px; border:1px solid #e0e0e0; color:#05b}' >> $out
echo '  a:hover, a:focus, a:active {border-color:#bcd; text-decoration:none; outline:0 none}' >> $out
echo '  .last-child a.trigger{padding-left:1px; background-image:none; font-weight:normal}' >> $out
echo '  .last-child a.trigger.open {background-image: none}' >> $out

echo '  h1, h2, h3 {margin-bottom:1em}' >> $out
echo '  h2, h3, h4 a, h5 a {padding:3px 10px}' >> $out
echo '  h2, h3, h4, h5 {font-size:1em}' >> $out
echo '</style>' >> $out

echo '<title>'$tag'</title>' >> $out
echo '</head>' >> $out
echo '<body>' >> $out
echo '<div id="main">' >> $out
echo '  <p>Last update: '$date'</p>' >> $out
echo '  <h1><a name="phys"></a>Physical observables</h1>' >> $out
echo '  <hr><br>' >> $out
echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Plaquette ('$tag')</th><th>Chiral condensate ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="plaq"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("plaq"),' >> $out   # Where to put graph
echo '                            "data/plaq.csv",' >> $out                   # URL for data series
echo '                            { rollPeriod: 50,' >> $out                  # Options
echo '                              colors: ["blue", "orange", "red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="pbp"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("pbp"),' >> $out
echo '                            "data/pbp.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "orange"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 6)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Polyakov loop ('$tag')</th><th>Spatial loop ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="poly"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("poly"),' >> $out
echo '                            "data/poly.csv",' >> $out
echo '                            { colors: ["blue"],' >> $out
echo '                              drawPoints: true,' >> $out
echo '                              strokeWidth: 0,' >> $out
#echo '                              valueRange: [-0.25, 0.25],' >> $out
echo '                              showLabelsOnHighlight: false,' >> $out
echo '                              xValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpoly"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpoly"),' >> $out
echo '                            "data/xpoly.csv",' >> $out
echo '                            { colors: ["blue"],' >> $out
echo '                              drawPoints: true,' >> $out
echo '                              strokeWidth: 0,' >> $out
#echo '                              valueRange: [-0.25, 0.25],' >> $out
echo '                              showLabelsOnHighlight: false,' >> $out
echo '                              xValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Re(Polyakov loop) ('$tag')</th><th>Polyakov loop mod ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="poly_r"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("poly_r"),' >> $out
echo '                            "data/poly_r.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["blue"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="poly_mod"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("poly_mod"),' >> $out
echo '                            "data/poly_mod.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["blue"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Re(spatial loop) ('$tag')</th><th>Spatial loop mod ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpoly_r"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpoly_r"),' >> $out
echo '                            "data/xpoly_r.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["blue"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpoly_mod"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpoly_mod"),' >> $out
echo '                            "data/xpoly_mod.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["blue"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Plaquette difference ('$tag')</th><th>Link difference ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="plaq_diff"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("plaq_diff"),' >> $out
echo '                            "data/plaq_diff.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="link_diff"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("link_diff"),' >> $out
echo '                            "data/link_diff.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Eigenvalues ('$tag')</th><th>g<sup>2</sup> from Wilson flow ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="eig"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("eig"),' >> $out
echo '                            "data/eig.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="Wflow"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("Wflow"),' >> $out
echo '                            "data/Wflow.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "red", "green", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Topological charge ('$tag')</th><th>Wilson-flowed Polyakov loop ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="topo"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("topo"),' >> $out
echo '                            "data/topo.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "red", "green", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 3)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="Wpoly"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("Wpoly"),' >> $out
echo '                            "data/Wpoly.csv",' >> $out
echo '                            { rollPeriod: 5,' >> $out
echo '                              colors: ["blue", "red", "green", "black"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out
echo '  <br><br><p align="right"><a href="#top">Return to top</a></p>' >> $out

echo '  <h1><a name="blocked"></a>Blocked observables</h1>' >> $out
echo '  <hr><br>' >> $out
echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Plaquette ('$tag')</th><th>Intentionally left blank</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="plaqB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("plaqB"),' >> $out
echo '                            "data/plaqB.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Polyakov loop ('$tag')</th><th>Spatial loop ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="polyB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("polyB"),' >> $out
echo '                            "data/polyB.csv",' >> $out
echo '                            { colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              drawPoints: true,' >> $out
echo '                              strokeWidth: 0,' >> $out
#echo '                              valueRange: [-0.25, 0.25],' >> $out
echo '                              showLabelsOnHighlight: false,' >> $out
echo '                              xValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpolyB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpolyB"),' >> $out
echo '                            "data/xpolyB.csv",' >> $out
echo '                            { colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              drawPoints: true,' >> $out
echo '                              strokeWidth: 0,' >> $out
#echo '                              valueRange: [-0.25, 0.25],' >> $out
echo '                              showLabelsOnHighlight: false,' >> $out
echo '                              xValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Re(Polyakov loop) ('$tag')</th><th>Polyakov loop mod ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="poly_rB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("poly_rB"),' >> $out
echo '                            "data/poly_rB.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="poly_modB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("poly_modB"),' >> $out
echo '                            "data/poly_modB.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Re(spatial loop) ('$tag')</th><th>Spatial loop mod ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpoly_rB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpoly_rB"),' >> $out
echo '                            "data/xpoly_rB.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="xpoly_modB"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("xpoly_modB"),' >> $out
echo '                            "data/xpoly_modB.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["blue", "orange", "red", "green", "purple"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br><p align="right"><a href="#top">Return to top</a></p>' >> $out

echo '  <h1><a name="evol"></a>Evolution observables</h1>' >> $out
echo '  <hr><br>' >> $out
echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>HMC accept/reject ('$tag')</th><th>e(-delta S) ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="accP"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("accP"),' >> $out
echo '                            "data/accP.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 3)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="exp_dS"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("exp_dS"),' >> $out
echo '                            "data/exp_dS.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>delta S ('$tag')</th><th>|delta S| ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="deltaS"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("deltaS"),' >> $out
echo '                            "data/deltaS.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              valueRange: [-2.5, 2.5],' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="abs_dS"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("abs_dS"),' >> $out
echo '                            "data/abs_dS.csv",' >> $out
echo '                            { rollPeriod: 50,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              valueRange: [0, 5],' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 4)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Forces ('$tag')</th><th>CG iters per traj ('$tag')</th></tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="force"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("force"),' >> $out
echo '                            "data/force.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red", "blue", "green"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 6)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="cg_iters"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("cg_iters"),' >> $out
echo '                            "data/cg_iters.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 1)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Walltime per traj ('$tag')</th><th>Core-minutes per MDTU ('$tag')</th></th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="walltime"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("walltime"),' >> $out
echo '                            "data/walltime.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 1)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="wallTU"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("wallTU"),' >> $out
echo '                            "data/wallTU.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 1)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br><p align="right"><a href="#top">Return to top</a></p>' >> $out

echo '  <h1><a name="run"></a>Run parameters</h1>' >> $out
echo '  <hr><br>' >> $out
echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Steps per trajec ('$tag')</th><th>HMC step size ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="Nstep"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("Nstep"),' >> $out
echo '                            "data/Nstep.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red", "blue", "green"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 1)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="stepsize"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("stepsize"),' >> $out
echo '                            "data/stepsize.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["red", "blue", "green"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 5)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br>' >> $out

echo '  <div style="width:880px; height:330px;">' >> $out
echo '    <table>' >> $out
echo '      <tr><th>Hasenbusch mass ('$tag')</th><th>Trajectory length ('$tag')</th></tr>' >> $out
echo '      <tr>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="MH"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("MH"),' >> $out
echo '                            "data/MH.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["green"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 3)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '        <td style="width:400px; height:300px;">' >> $out
echo '          <div id="tlength"></div>' >> $out
echo '          <script type="text/javascript">' >> $out
echo '            g = new Dygraph(document.getElementById("tlength"),' >> $out
echo '                            "data/tlength.csv",' >> $out
echo '                            { rollPeriod: 1,' >> $out
echo '                              colors: ["green"],' >> $out
echo '                              showRoller: true,' >> $out
echo '                              yValueFormatter: function(x) {' >> $out
echo '                                var shift = Math.pow(10, 3)' >> $out
echo '                                return Math.round(x * shift) / shift' >> $out
echo '                              },' >> $out
echo '                            });' >> $out
echo '          </script>' >> $out
echo '        </td>' >> $out
echo '      </tr>' >> $out
echo '    </table>' >> $out
echo '  </div>' >> $out
echo '  <br><br><p align="right"><a href="#top">Return to top</a></p>' >> $out
echo '</div>' >> $out
echo '</body>' >> $out
echo '</html>' >> $out
